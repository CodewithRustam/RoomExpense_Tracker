// Views/Expenses/Add.cshtml
@model RoomExpenseTracker.Models.ExpenseViewModel

@{
    ViewData["Title"] = "Add Expense";
}

<div class="container mx-auto p-4 max-w-md">
    <h1 class="text-2xl font-bold mb-4">Add New Expense</h1>

    <!-- Debugging output -->
    <p class="text-gray-500">Debug: @Model.Members.Count members available</p>

    <form asp-action="Add" class="space-y-4">
        <input type="hidden" asp-for="RoomId" />
        <input type="hidden" asp-for="Expense.RoomId" />
        <div>
            <label asp-for="Expense.MemberId" class="block text-sm font-medium">Member</label>
            @if (Model.Members.Any())
            {
                <select asp-for="Expense.MemberId" asp-items="@Model.Members" class="w-full p-2 border rounded">
                    <option value="">Select a member</option>
                </select>
            }
            else
            {
                <p class="text-red-500">No members available. Please add members to the room first.</p>
                <select asp-for="Expense.MemberId" class="w-full p-2 border rounded" disabled>
                    <option value="">No members</option>
                </select>
            }
            <span asp-validation-for="Expense.MemberId" class="text-red-500 text-sm"></span>
        </div>
        <div>
            <label asp-for="Expense.Item" class="block text-sm font-medium">Item</label>
            <input asp-for="Expense.Item" class="w-full p-2 border rounded" placeholder="e.g., Groceries" />
            <span asp-validation-for="Expense.Item" class="text-red-500 text-sm"></span>
        </div>
        <div>
            <label asp-for="Expense.Amount" class="block text-sm font-medium">Amount</label>
            <input asp-for="Expense.Amount" class="w-full p-2 border rounded" type="number" step="0.01" placeholder="e.g., 25.50" />
            <span asp-validation-for="Expense.Amount" class="text-red-500 text-sm"></span>
        </div>
        <div>
            <label asp-for="Expense.Date" class="block text-sm font-medium">Date</label>
            <input asp-for="Expense.Date" class="w-full p-2 border rounded" type="date" value="@Model.Expense.Date.ToString("yyyy-MM-dd")" />
            <span asp-validation-for="Expense.Date" class="text-red-500 text-sm"></span>
        </div>
        <div>
            <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Save</button>
            <a asp-controller="Rooms" asp-action="Details" asp-route-id="@Model.RoomId" class="text-gray-600 px-4 py-2">Cancel</a>
        </div>
    </form>
</div>

@section Scripts {
    <script src="https://cdn.tailwindcss.com"></script>
    <partial name="_ValidationScriptsPartial" />
}